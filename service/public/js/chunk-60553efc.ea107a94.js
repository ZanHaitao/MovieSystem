(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-60553efc"],{"05ce":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"session-list"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{name:"cinemaIndex"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("影片场次")])],1),a("dir",{staticClass:"session-content"},[a("el-card",{class:"data-item",attrs:{shadow:"hover"}},[a("div",{staticClass:"add-session",on:{click:e.handleAddScreen}},[e._v(" 添加场次 ")]),a("el-collapse",{attrs:{accordion:""},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.movieListData.data,(function(t){return a("el-collapse-item",{key:t.id,attrs:{title:t.name,name:t.id}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.session,stripe:""}},[a("el-table-column",{attrs:{prop:"showDate",label:"放映日期"}}),a("el-table-column",{attrs:{prop:"showTime",label:"放映时间"}}),a("el-table-column",{attrs:{prop:"language",label:"语言版本"}}),a("el-table-column",{attrs:{prop:"screen",label:"放映厅"}}),a("el-table-column",{attrs:{prop:"price",label:"售价"}}),a("el-table-column",{attrs:{prop:"id",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")])]}}],null,!0)})],1)],1)})),1)],1)],1),a("el-dialog",{attrs:{title:"添加修改影厅",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.form1}},[a("el-form-item",{attrs:{label:"场次时间","label-width":e.formLabelWidth}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm",type:"datetime",placeholder:"选择日期时间"},model:{value:e.form1.date,callback:function(t){e.$set(e.form1,"date",t)},expression:"form1.date"}})],1),a("el-form-item",{attrs:{disabled:"",label:"语言版本","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form1.language,callback:function(t){e.$set(e.form1,"language",t)},expression:"form1.language"}})],1),a("el-form-item",{attrs:{disabled:"",label:"场次售价","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form1.price,callback:function(t){e.$set(e.form1,"price",t)},expression:"form1.price"}})],1),a("el-form-item",{attrs:{disabled:"",label:"电影名称","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form1.movieName,callback:function(t){e.$set(e.form1,"movieName",t)},expression:"form1.movieName"}},e._l(e.movieOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{disabled:"",label:"影厅名称","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.handleChangeScreen},model:{value:e.form1.screenName,callback:function(t){e.$set(e.form1,"screenName",t)},expression:"form1.screenName"}},e._l(e.screenOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"seat-content"},[a("div",{staticClass:"title-tip"},[a("span",[e._v("可选座位")]),a("span",[e._v("空白过道")])]),a("div",{staticClass:"seat-container"},[a("div",{staticClass:"tip"},[a("ul",e._l(e.seat,(function(t,n){return a("li",{key:n},[e._v(" "+e._s(e.letterList[n])+" ")])})),0)]),a("div",{staticClass:"right"},[a("div",{staticClass:"screen"},[e._v(" 银幕中央 ")]),a("div",{staticClass:"screen-content"},[a("ul",e._l(e.seat,(function(t,n){return a("li",{key:n,staticClass:"row"},[a("ul",e._l(t,(function(e,t){return a("li",{key:t,staticClass:"col",class:{active1:0===e,active2:1===e,active3:2===e,active4:3===e}})})),0)])})),0)])])])]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("关 闭")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleAddSession}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"添加修改影厅",visible:e.EditFormVisible},on:{"update:visible":function(t){e.EditFormVisible=t}}},[a("el-form",{attrs:{model:e.form2}},[a("el-form-item",{attrs:{label:"场次时间","label-width":e.formLabelWidth}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm",type:"datetime",placeholder:"选择日期时间"},model:{value:e.form2.date,callback:function(t){e.$set(e.form2,"date",t)},expression:"form2.date"}})],1),a("el-form-item",{attrs:{disabled:"",label:"语言版本","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form2.language,callback:function(t){e.$set(e.form2,"language",t)},expression:"form2.language"}})],1),a("el-form-item",{attrs:{disabled:"",label:"场次售价","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form2.price,callback:function(t){e.$set(e.form2,"price",t)},expression:"form2.price"}})],1),a("el-form-item",{attrs:{disabled:"",label:"电影名称","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form2.movieName,callback:function(t){e.$set(e.form2,"movieName",t)},expression:"form2.movieName"}},e._l(e.movieOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{disabled:"",label:"影厅名称","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form2.screenName,callback:function(t){e.$set(e.form2,"screenName",t)},expression:"form2.screenName"}},e._l(e.screenOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"seat-content"},[a("div",{staticClass:"title-tip"},[a("span",[e._v("可选座位")]),a("span",[e._v("空白过道")])]),a("div",{staticClass:"seat-container"},[a("div",{staticClass:"tip"},[a("ul",e._l(e.seat,(function(t,n){return a("li",{key:n},[e._v(" "+e._s(e.letterList[n])+" ")])})),0)]),a("div",{staticClass:"right"},[a("div",{staticClass:"screen"},[e._v(" 银幕中央 ")]),a("div",{staticClass:"screen-content"},[a("ul",e._l(e.seat,(function(t,n){return a("li",{key:n,staticClass:"row"},[a("ul",e._l(t,(function(e,t){return a("li",{key:t,staticClass:"col",class:{active1:0===e,active2:1===e,active3:2===e,active4:3===e}})})),0)])})),0)])])])]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.EditFormVisible=!1}}},[e._v("关 闭")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleEditSession}},[e._v("确 定")])],1)],1)],1)},r=[],i=(a("d81d"),a("b0c0"),a("ac1f"),a("1276"),a("5530")),l=(a("96cf"),a("1da1")),s=(a("c1df"),{data:function(){return{movieListData:{},activeName:"1",dialogFormVisible:!1,EditFormVisible:!1,movieOptions:[],screenOptions:[],formLabelWidth:"120px",seat:[],letterList:["A","B","C","D","E","F","G","H","I","J","K","L","M","N"],form1:{date:"",price:"",language:"",movieName:"",screenName:""},form2:{id:"",date:"",price:"",language:"",movieName:"",screenName:""}}},created:function(){var e=this;setTimeout((function(){void 0===e.$store.state.loginCinema.name&&e.$router.push({name:"cinemaLogin"}),e.getData()}),1e3),this.getScreeenData().then((function(t){e.screenOptions=t.data.map((function(e){return{value:e.name,label:e.name}}))})),this.getMovieData().then((function(t){e.movieOptions=t.data.map((function(e){return{value:e.name,label:e.name}}))}))},methods:{handleAddScreen:function(){this.dialogFormVisible=!0},handleChangeScreen:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getScreeenData({name:e.form1.screenName});case 2:a=t.sent,e.seat=JSON.parse(a.data[0].seat);case 4:case"end":return t.stop()}}),t)})))()},handleAddSession:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!==e.form1.date&&""!==e.form1.language&&""!==e.form1.movieName&&""!==e.form1.screenName&&""!==e.form1.price){t.next=3;break}return e.warning(),t.abrupt("return");case 3:return t.next=5,e.getMovieData({name:e.form1.movieName});case 5:return a=t.sent,t.next=8,e.getScreeenData({name:e.form1.screenName});case 8:return n=t.sent,t.next=11,e.$api.addSession({showDate:e.form1.date.split(" ")[0],showTime:e.form1.date.split(" ")[1],language:e.form1.language,price:e.form1.price,CinemaId:e.$store.state.loginCinema.id,MovieId:a.data[0].id,ScreenId:n.data[0].id,seat:JSON.stringify(e.seat)},"cinema");case 11:r=t.sent,r?(e.success("添加成功"),e.getData(),e.dialogFormVisible=!1,e.seat=[],e.form1.date="",e.form1.price="",e.form1.language="",e.form1.movieName="",e.form1.screenName=""):e.error("添加");case 13:case"end":return t.stop()}}),t)})))()},handleEdit:function(e){this.form2.id=e.id,this.form2.date=e.showDate+" "+e.showTime,this.form2.price=e.price,this.form2.language=e.language,this.form2.movieName=e.Movie.name,this.form2.screenName=e.Screen.name,this.seat=JSON.parse(e.seat),this.EditFormVisible=!0},handleDelete:function(e){var t=this;this.$confirm("此操作将删除该管理员, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$api.deleteSession(e.id,"cinema").then((function(e){e?(t.success("删除成功"),t.getData()):t.error("删除")}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleEditSession:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!==e.form2.date&&""!==e.form2.language&&""!==e.form2.movieName&&""!==e.form2.screenName&&""!==e.form2.price){t.next=3;break}return e.warning(),t.abrupt("return");case 3:return t.next=5,e.getMovieData({name:e.form2.movieName});case 5:return a=t.sent,t.next=8,e.getScreeenData({name:e.form2.screenName});case 8:return n=t.sent,t.next=11,e.$api.updateSession(e.form2.id,{showDate:e.form2.date.split(" ")[0],showTime:e.form2.date.split(" ")[1],language:e.form2.language,price:e.form2.price,CinemaId:e.$store.state.loginCinema.id,MovieId:a.data[0].id,ScreenId:n.data[0].id,seat:JSON.stringify(e.seat)},"cinema");case 11:r=t.sent,r?(e.success("修改成功"),e.EditFormVisible=!1,e.getData()):e.error("修改");case 13:case"end":return t.stop()}}),t)})))()},getMovieData:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$api.getMovieList(Object(i["a"])({limit:9999999},e),"cinema");case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),a)})))()},getScreeenData:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$api.getScreensList(Object(i["a"])({limit:99999},e),"cinema");case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),a)})))()},getData:function(){var e=this;this.$api.getSessionList({cinemaid:this.$store.state.loginCinema.id,limit:999},"cinema").then((function(t){for(var a={},n=0;n<t.data.length;n++){var r=t.data[n];a[r.Movie.name]||(a[r.Movie.name]=r.Movie)}var i=function(t){var n=a[t];e.$api.getSessionList({cinemaid:e.$store.state.loginCinema.id,movieid:n.id},"cinema").then((function(e){a[t].session=e.data,a[t].session=a[t].session.map((function(t,a){return t.screen=e.data[a].Screen.name,t}))}))};for(var l in a)i(l);e.$set(e.movieListData,"data",a)}))},warning:function(){this.$notify({title:"警告",message:"信息填写不完整！",type:"warning"})},success:function(e){this.$notify({title:e,message:e+"!",type:"success"})},error:function(e){this.$notify.error({title:"失败",message:e+"失败！"})}}}),o=s,c=(a("a889"),a("2877")),u=Object(c["a"])(o,n,r,!1,null,null,null);t["default"]=u.exports},1276:function(e,t,a){"use strict";var n=a("d784"),r=a("44e7"),i=a("825a"),l=a("1d80"),s=a("4840"),o=a("8aa5"),c=a("50c4"),u=a("14c3"),m=a("9263"),d=a("d039"),f=[].push,p=Math.min,v=4294967295,g=!d((function(){return!RegExp(v,"y")}));n("split",2,(function(e,t,a){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,a){var n=String(l(this)),i=void 0===a?v:a>>>0;if(0===i)return[];if(void 0===e)return[n];if(!r(e))return t.call(n,e,i);var s,o,c,u=[],d=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),p=0,g=new RegExp(e.source,d+"g");while(s=m.call(g,n)){if(o=g.lastIndex,o>p&&(u.push(n.slice(p,s.index)),s.length>1&&s.index<n.length&&f.apply(u,s.slice(1)),c=s[0].length,p=o,u.length>=i))break;g.lastIndex===s.index&&g.lastIndex++}return p===n.length?!c&&g.test("")||u.push(""):u.push(n.slice(p)),u.length>i?u.slice(0,i):u}:"0".split(void 0,0).length?function(e,a){return void 0===e&&0===a?[]:t.call(this,e,a)}:t,[function(t,a){var r=l(this),i=void 0==t?void 0:t[e];return void 0!==i?i.call(t,r,a):n.call(String(r),t,a)},function(e,r){var l=a(n,e,this,r,n!==t);if(l.done)return l.value;var m=i(e),d=String(this),f=s(m,RegExp),h=m.unicode,b=(m.ignoreCase?"i":"")+(m.multiline?"m":"")+(m.unicode?"u":"")+(g?"y":"g"),x=new f(g?m:"^(?:"+m.source+")",b),y=void 0===r?v:r>>>0;if(0===y)return[];if(0===d.length)return null===u(x,d)?[d]:[];var w=0,k=0,E=[];while(k<d.length){x.lastIndex=g?k:0;var N,C=u(x,g?d:d.slice(k));if(null===C||(N=p(c(x.lastIndex+(g?0:k)),d.length))===w)k=o(d,k,h);else{if(E.push(d.slice(w,k)),E.length===y)return E;for(var _=1;_<=C.length-1;_++)if(E.push(C[_]),E.length===y)return E;k=w=N}}return E.push(d.slice(w)),E}]}),!g)},"14c3":function(e,t,a){var n=a("c6b6"),r=a("9263");e.exports=function(e,t){var a=e.exec;if("function"===typeof a){var i=a.call(e,t);if("object"!==typeof i)throw TypeError("RegExp exec method returned something other than an Object or null");return i}if("RegExp"!==n(e))throw TypeError("RegExp#exec called on incompatible receiver");return r.call(e,t)}},"44e7":function(e,t,a){var n=a("861d"),r=a("c6b6"),i=a("b622"),l=i("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[l])?!!t:"RegExp"==r(e))}},6547:function(e,t,a){var n=a("a691"),r=a("1d80"),i=function(e){return function(t,a){var i,l,s=String(r(t)),o=n(a),c=s.length;return o<0||o>=c?e?"":void 0:(i=s.charCodeAt(o),i<55296||i>56319||o+1===c||(l=s.charCodeAt(o+1))<56320||l>57343?e?s.charAt(o):i:e?s.slice(o,o+2):l-56320+(i-55296<<10)+65536)}};e.exports={codeAt:i(!1),charAt:i(!0)}},"8aa5":function(e,t,a){"use strict";var n=a("6547").charAt;e.exports=function(e,t,a){return t+(a?n(e,t).length:1)}},9263:function(e,t,a){"use strict";var n=a("ad6d"),r=a("9f7f"),i=RegExp.prototype.exec,l=String.prototype.replace,s=i,o=function(){var e=/a/,t=/b*/g;return i.call(e,"a"),i.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),c=r.UNSUPPORTED_Y||r.BROKEN_CARET,u=void 0!==/()??/.exec("")[1],m=o||u||c;m&&(s=function(e){var t,a,r,s,m=this,d=c&&m.sticky,f=n.call(m),p=m.source,v=0,g=e;return d&&(f=f.replace("y",""),-1===f.indexOf("g")&&(f+="g"),g=String(e).slice(m.lastIndex),m.lastIndex>0&&(!m.multiline||m.multiline&&"\n"!==e[m.lastIndex-1])&&(p="(?: "+p+")",g=" "+g,v++),a=new RegExp("^(?:"+p+")",f)),u&&(a=new RegExp("^"+p+"$(?!\\s)",f)),o&&(t=m.lastIndex),r=i.call(d?a:m,g),d?r?(r.input=r.input.slice(v),r[0]=r[0].slice(v),r.index=m.lastIndex,m.lastIndex+=r[0].length):m.lastIndex=0:o&&r&&(m.lastIndex=m.global?r.index+r[0].length:t),u&&r&&r.length>1&&l.call(r[0],a,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(r[s]=void 0)})),r}),e.exports=s},"9f7f":function(e,t,a){"use strict";var n=a("d039");function r(e,t){return RegExp(e,t)}t.UNSUPPORTED_Y=n((function(){var e=r("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=n((function(){var e=r("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},a4fb:function(e,t,a){},a889:function(e,t,a){"use strict";var n=a("a4fb"),r=a.n(n);r.a},ac1f:function(e,t,a){"use strict";var n=a("23e7"),r=a("9263");n({target:"RegExp",proto:!0,forced:/./.exec!==r},{exec:r})},ad6d:function(e,t,a){"use strict";var n=a("825a");e.exports=function(){var e=n(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},d784:function(e,t,a){"use strict";a("ac1f");var n=a("6eeb"),r=a("d039"),i=a("b622"),l=a("9263"),s=a("9112"),o=i("species"),c=!r((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),u=function(){return"$0"==="a".replace(/./,"$0")}(),m=i("replace"),d=function(){return!!/./[m]&&""===/./[m]("a","$0")}(),f=!r((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var a="ab".split(e);return 2!==a.length||"a"!==a[0]||"b"!==a[1]}));e.exports=function(e,t,a,m){var p=i(e),v=!r((function(){var t={};return t[p]=function(){return 7},7!=""[e](t)})),g=v&&!r((function(){var t=!1,a=/a/;return"split"===e&&(a={},a.constructor={},a.constructor[o]=function(){return a},a.flags="",a[p]=/./[p]),a.exec=function(){return t=!0,null},a[p](""),!t}));if(!v||!g||"replace"===e&&(!c||!u||d)||"split"===e&&!f){var h=/./[p],b=a(p,""[e],(function(e,t,a,n,r){return t.exec===l?v&&!r?{done:!0,value:h.call(t,a,n)}:{done:!0,value:e.call(a,t,n)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:d}),x=b[0],y=b[1];n(String.prototype,e,x),n(RegExp.prototype,p,2==t?function(e,t){return y.call(e,this,t)}:function(e){return y.call(e,this)})}m&&s(RegExp.prototype[p],"sham",!0)}}}]);
//# sourceMappingURL=chunk-60553efc.ea107a94.js.map